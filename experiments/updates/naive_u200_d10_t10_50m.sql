\o /dev/null
\timing ON

create temporary table g1 as (select * from g);
create index community_area_index ON g1 (pickup_community_area);

update g1 set fare = fare + 69 where pickup_community_area <= 7;
update g1 set trip_total = trip_total + 7 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 40 where pickup_community_area >= 33;
update g1 set extras = extras + 40 where pickup_community_area >= 33;
update g1 set fare = fare + 10 where pickup_community_area >= 33;
update g1 set extras = extras + 46 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 79 where pickup_community_area >= 33;
update g1 set tolls = tolls + 55 where pickup_community_area >= 33;
update g1 set fare = fare + 27 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 5 where pickup_community_area >= 33;
update g1 set extras = extras + 81 where pickup_community_area >= 33;
update g1 set tolls = tolls + 71 where pickup_community_area >= 61;
update g1 set trip_total = trip_total + 74 where pickup_community_area >= 33;
update g1 set extras = extras + 69 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 99 where pickup_community_area >= 33;
update g1 set fare = fare + 76 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 50 where pickup_community_area >= 33;
update g1 set tolls = tolls + 22 where pickup_community_area >= 33;
update g1 set tolls = tolls + 26 where pickup_community_area >= 33;
update g1 set tolls = tolls + 78 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 12 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 49 where pickup_community_area >= 33;
update g1 set fare = fare + 86 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 69 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 50 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 86 where pickup_community_area >= 33;
update g1 set tolls = tolls + 46 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 38 where pickup_community_area >= 33;
update g1 set fare = fare + 81 where pickup_community_area >= 33;
update g1 set tolls = tolls + 34 where pickup_community_area >= 33;
update g1 set fare = fare + 50 where pickup_community_area >= 33;
update g1 set fare = fare + 75 where pickup_community_area >= 33;
update g1 set fare = fare + 43 where pickup_community_area >= 33;
update g1 set extras = extras + 100 where pickup_community_area >= 33;
update g1 set extras = extras + 89 where pickup_community_area >= 33;
update g1 set fare = fare + 37 where pickup_community_area >= 33;
update g1 set tolls = tolls + 46 where pickup_community_area >= 33;
update g1 set tolls = tolls + 82 where pickup_community_area >= 33;
update g1 set fare = fare + 35 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 11 where pickup_community_area >= 33;
update g1 set extras = extras + 1 where pickup_community_area >= 33;
update g1 set extras = extras + 84 where pickup_community_area >= 33;
update g1 set fare = fare + 46 where pickup_community_area >= 33;
update g1 set fare = fare + 48 where pickup_community_area >= 33;
update g1 set extras = extras + 8 where pickup_community_area >= 33;
update g1 set fare = fare + 49 where pickup_community_area >= 33;
update g1 set extras = extras + 67 where pickup_community_area >= 33;
update g1 set tolls = tolls + 96 where pickup_community_area >= 33;
update g1 set fare = fare + 73 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 80 where pickup_community_area >= 33;
update g1 set fare = fare + 80 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 72 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 47 where pickup_community_area >= 33;
update g1 set tolls = tolls + 17 where pickup_community_area >= 33;
update g1 set tolls = tolls + 50 where pickup_community_area >= 33;
update g1 set tolls = tolls + 87 where pickup_community_area >= 33;
update g1 set tolls = tolls + 68 where pickup_community_area >= 33;
update g1 set fare = fare + 54 where pickup_community_area >= 33;
update g1 set extras = extras + 5 where pickup_community_area >= 33;
update g1 set extras = extras + 13 where pickup_community_area >= 33;
update g1 set fare = fare + 13 where pickup_community_area >= 33;
update g1 set tolls = tolls + 13 where pickup_community_area >= 33;
update g1 set extras = extras + 56 where pickup_community_area >= 33;
update g1 set extras = extras + 50 where pickup_community_area >= 33;
update g1 set fare = fare + 94 where pickup_community_area >= 33;
update g1 set tolls = tolls + 10 where pickup_community_area >= 33;
update g1 set tolls = tolls + 29 where pickup_community_area >= 33;
update g1 set tolls = tolls + 4 where pickup_community_area >= 33;
update g1 set tolls = tolls + 78 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 28 where pickup_community_area >= 33;
update g1 set tolls = tolls + 2 where pickup_community_area >= 33;
update g1 set tolls = tolls + 70 where pickup_community_area >= 33;
update g1 set extras = extras + 41 where pickup_community_area >= 33;
update g1 set extras = extras + 43 where pickup_community_area >= 33;
update g1 set fare = fare + 31 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 86 where pickup_community_area >= 33;
update g1 set tolls = tolls + 32 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 31 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 32 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 0 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 61 where pickup_community_area >= 33;
update g1 set fare = fare + 65 where pickup_community_area <= 7;
update g1 set tolls = tolls + 75 where pickup_community_area <= 7;
update g1 set fare = fare + 6 where pickup_community_area <= 7;
update g1 set tolls = tolls + 100 where pickup_community_area <= 7;
update g1 set tolls = tolls + 100 where pickup_community_area <= 7;
update g1 set fare = fare + 3 where pickup_community_area <= 7;
update g1 set fare = fare + 9 where pickup_community_area <= 7;
update g1 set extras = extras + 1 where pickup_community_area <= 7;
update g1 set extras = extras + 50 where pickup_community_area <= 7;
update g1 set fare = fare + 61 where pickup_community_area <= 7;
update g1 set fare = fare + 98 where pickup_community_area <= 7;
update g1 set fare = fare + 91 where pickup_community_area <= 7;
update g1 set extras = extras + 53 where pickup_community_area <= 7;
update g1 set extras = extras + 25 where pickup_community_area <= 7;
update g1 set tolls = tolls + 74 where pickup_community_area <= 7;
update g1 set extras = extras + 0 where pickup_community_area <= 7;
update g1 set trip_total = trip_total + 7 where pickup_community_area <= 7;
update g1 set extras = extras + 96 where pickup_community_area <= 7;
update g1 set trip_total = trip_total + 39 where pickup_community_area <= 7;
update g1 set extras = extras + 90 where pickup_community_area <= 7;
update g1 set tolls = tolls + 76 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 73 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 54 where pickup_community_area >= 33;
update g1 set fare = fare + 32 where pickup_community_area >= 25;
update g1 set trip_total = trip_total + 63 where pickup_community_area >= 33;
update g1 set fare = fare + 85 where pickup_community_area >= 33;
update g1 set extras = extras + 56 where pickup_community_area >= 33;
update g1 set tolls = tolls + 62 where pickup_community_area >= 33;
update g1 set fare = fare + 47 where pickup_community_area >= 33;
update g1 set fare = fare + 38 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 84 where pickup_community_area >= 33;
update g1 set extras = extras + 8 where pickup_community_area >= 33;
update g1 set tolls = tolls + 17 where pickup_community_area >= 33;
update g1 set fare = fare + 36 where pickup_community_area >= 33;
update g1 set tolls = tolls + 58 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 93 where pickup_community_area >= 33;
update g1 set extras = extras + 67 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 16 where pickup_community_area >= 33;
update g1 set fare = fare + 34 where pickup_community_area >= 33;
update g1 set tolls = tolls + 27 where pickup_community_area >= 33;
update g1 set fare = fare + 44 where pickup_community_area >= 33;
update g1 set tolls = tolls + 14 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 85 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 9 where pickup_community_area >= 33;
update g1 set extras = extras + 18 where pickup_community_area >= 33;
update g1 set tolls = tolls + 14 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 49 where pickup_community_area >= 33;
update g1 set tolls = tolls + 97 where pickup_community_area >= 33;
update g1 set tolls = tolls + 37 where pickup_community_area >= 33;
update g1 set fare = fare + 29 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 40 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 32 where pickup_community_area >= 33;
update g1 set fare = fare + 66 where pickup_community_area >= 33;
update g1 set extras = extras + 96 where pickup_community_area >= 33;
update g1 set extras = extras + 87 where pickup_community_area >= 33;
update g1 set extras = extras + 60 where pickup_community_area >= 33;
update g1 set tolls = tolls + 75 where pickup_community_area >= 33;
update g1 set extras = extras + 28 where pickup_community_area >= 33;
update g1 set fare = fare + 9 where pickup_community_area >= 33;
update g1 set extras = extras + 11 where pickup_community_area >= 33;
update g1 set extras = extras + 19 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 9 where pickup_community_area >= 33;
update g1 set fare = fare + 13 where pickup_community_area >= 33;
update g1 set fare = fare + 46 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 50 where pickup_community_area >= 33;
update g1 set fare = fare + 13 where pickup_community_area >= 33;
update g1 set fare = fare + 45 where pickup_community_area >= 33;
update g1 set extras = extras + 82 where pickup_community_area >= 33;
update g1 set extras = extras + 6 where pickup_community_area >= 33;
update g1 set tolls = tolls + 83 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 56 where pickup_community_area >= 33;
update g1 set tolls = tolls + 34 where pickup_community_area >= 33;
update g1 set fare = fare + 38 where pickup_community_area >= 33;
update g1 set tolls = tolls + 45 where pickup_community_area >= 33;
update g1 set fare = fare + 83 where pickup_community_area >= 33;
update g1 set tolls = tolls + 65 where pickup_community_area >= 33;
update g1 set fare = fare + 35 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 9 where pickup_community_area >= 33;
update g1 set fare = fare + 92 where pickup_community_area >= 33;
update g1 set extras = extras + 30 where pickup_community_area >= 33;
update g1 set fare = fare + 78 where pickup_community_area >= 33;
update g1 set fare = fare + 15 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 23 where pickup_community_area >= 33;
update g1 set tolls = tolls + 64 where pickup_community_area >= 33;
update g1 set fare = fare + 92 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 17 where pickup_community_area >= 33;
update g1 set tolls = tolls + 20 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 64 where pickup_community_area >= 33;
update g1 set tolls = tolls + 0 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 91 where pickup_community_area >= 33;
update g1 set tolls = tolls + 8 where pickup_community_area >= 33;
update g1 set extras = extras + 6 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 59 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 84 where pickup_community_area >= 33;
update g1 set extras = extras + 40 where pickup_community_area >= 33;
update g1 set extras = extras + 79 where pickup_community_area >= 33;
update g1 set extras = extras + 30 where pickup_community_area >= 33;
update g1 set fare = fare + 0 where pickup_community_area >= 33;
update g1 set fare = fare + 22 where pickup_community_area >= 33;
update g1 set extras = extras + 35 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 41 where pickup_community_area >= 33;
update g1 set extras = extras + 80 where pickup_community_area >= 33;
update g1 set extras = extras + 53 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 81 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 78 where pickup_community_area >= 33;
update g1 set extras = extras + 1 where pickup_community_area >= 33;
update g1 set tolls = tolls + 33 where pickup_community_area >= 33;
update g1 set tolls = tolls + 97 where pickup_community_area >= 33;
update g1 set extras = extras + 17 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 99 where pickup_community_area >= 33;
update g1 set fare = fare + 58 where pickup_community_area >= 33;
update g1 set tolls = tolls + 80 where pickup_community_area >= 33;
update g1 set fare = fare + 99 where pickup_community_area >= 33;
update g1 set extras = extras + 98 where pickup_community_area >= 33;
update g1 set fare = fare + 49 where pickup_community_area >= 33;
update g1 set fare = fare + 17 where pickup_community_area >= 33;
update g1 set extras = extras + 8 where pickup_community_area >= 33;
update g1 set tolls = tolls + 61 where pickup_community_area >= 33;
update g1 set fare = fare + 65 where pickup_community_area >= 33;
update g1 set trip_total = trip_total + 39 where pickup_community_area >= 33;

explain analyze (select * from g except select * from g1) union (select * from g1 except select * from g);
