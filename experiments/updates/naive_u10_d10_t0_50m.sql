create temporary table g1 as (select * from g);
create index community_area_index ON g1 (pickup_community_area);
update g1 set tolls = tolls + 16 where pickup_community_area <= 1;
update g1 set fare = fare + 19 where pickup_community_area >= 77;
update g1 set extras = extras + 61 where pickup_community_area >= 77;
update g1 set fare = fare + 97 where pickup_community_area >= 77;
update g1 set fare = fare + 52 where pickup_community_area >= 77;
update g1 set tolls = tolls + 3 where pickup_community_area <= 1;
update g1 set trip_total = trip_total + 69 where pickup_community_area >= 77;
update g1 set extras = extras + 53 where pickup_community_area >= 77;
update g1 set trip_total = trip_total + 36 where pickup_community_area >= 77;
update g1 set tolls = tolls + 63 where pickup_community_area >= 77;
update g1 set extras = extras + 17 where pickup_community_area >= 77;
explain analyze (select * from g except select * from g1) union (select * from g1 except select * from g);
