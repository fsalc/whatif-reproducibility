create temporary table g1 as (select * from g);
create index community_area_index ON g1 (pickup_community_area);
update g1 set fare = fare + 8 where pickup_community_area <= 1;
update g1 set trip_total = trip_total + 96 where pickup_community_area > 43;
update g1 set extras = extras + 36 where pickup_community_area > 65;
update g1 set trip_total = trip_total + 2 where pickup_community_area > 37;
update g1 set trip_total = trip_total + 76 where pickup_community_area > 70;
update g1 set fare = fare + 78 where pickup_community_area > 51;
update g1 set tolls = tolls + 66 where pickup_community_area > 17;
update g1 set extras = extras + 95 where pickup_community_area > 45;
update g1 set tolls = tolls + 15 where pickup_community_area > 36;
update g1 set trip_total = trip_total + 62 where pickup_community_area <= 1;
update g1 set tolls = tolls + 52 where pickup_community_area <= 1;
update g1 set extras = extras + 91 where pickup_community_area > 16;
update g1 set trip_total = trip_total + 59 where pickup_community_area > 76;
update g1 set fare = fare + 30 where pickup_community_area > 22;
update g1 set extras = extras + 36 where pickup_community_area > 41;
update g1 set tolls = tolls + 64 where pickup_community_area > 29;
update g1 set tolls = tolls + 46 where pickup_community_area > 67;
update g1 set tolls = tolls + 36 where pickup_community_area > 31;
update g1 set tolls = tolls + 74 where pickup_community_area > 31;
update g1 set fare = fare + 100 where pickup_community_area > 46;
update g1 set trip_total = trip_total + 69 where pickup_community_area > 49;
explain analyze (select * from g except select * from g1) union (select * from g1 except select * from g);
