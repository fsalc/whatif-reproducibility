create temporary table g1 as (select * from g);
create index community_area_index ON g1 (pickup_community_area);
update g1 set trip_total = trip_total + 78 where pickup_community_area = 8;
update g1 set tolls = tolls + 45 where pickup_community_area > 11;
update g1 set fare = fare + 44 where pickup_community_area > 63;
update g1 set fare = fare + 62 where pickup_community_area > 40;
update g1 set fare = fare + 68 where pickup_community_area > 14;
update g1 set extras = extras + 33 where pickup_community_area > 23;
update g1 set extras = extras + 68 where pickup_community_area > 11;
update g1 set extras = extras + 59 where pickup_community_area > 51;
update g1 set trip_total = trip_total + 96 where pickup_community_area > 23;
update g1 set fare = fare + 19 where pickup_community_area > 46;
update g1 set fare = fare + 82 where pickup_community_area > 46;
update g1 set tolls = tolls + 66 where pickup_community_area > 28;
update g1 set fare = fare + 50 where pickup_community_area > 19;
update g1 set tolls = tolls + 90 where pickup_community_area > 8;
update g1 set fare = fare + 98 where pickup_community_area > 56;
update g1 set fare = fare + 20 where pickup_community_area > 36;
update g1 set trip_total = trip_total + 21 where pickup_community_area > 72;
update g1 set fare = fare + 100 where pickup_community_area > 73;
update g1 set fare = fare + 57 where pickup_community_area > 42;
update g1 set fare = fare + 97 where pickup_community_area > 57;
update g1 set trip_total = trip_total + 71 where pickup_community_area > 41;
update g1 set trip_total = trip_total + 24 where pickup_community_area > 35;
update g1 set tolls = tolls + 64 where pickup_community_area > 76;
update g1 set trip_total = trip_total + 29 where pickup_community_area > 49;
update g1 set trip_total = trip_total + 48 where pickup_community_area > 60;
update g1 set extras = extras + 25 where pickup_community_area > 75;
update g1 set tolls = tolls + 98 where pickup_community_area > 70;
update g1 set tolls = tolls + 90 where pickup_community_area > 10;
update g1 set extras = extras + 12 where pickup_community_area > 30;
update g1 set extras = extras + 0 where pickup_community_area > 26;
update g1 set fare = fare + 49 where pickup_community_area > 66;
update g1 set tolls = tolls + 4 where pickup_community_area > 33;
update g1 set tolls = tolls + 97 where pickup_community_area > 25;
update g1 set tolls = tolls + 67 where pickup_community_area > 74;
update g1 set fare = fare + 48 where pickup_community_area > 76;
update g1 set extras = extras + 93 where pickup_community_area > 21;
update g1 set trip_total = trip_total + 43 where pickup_community_area > 33;
update g1 set tolls = tolls + 51 where pickup_community_area > 11;
update g1 set tolls = tolls + 42 where pickup_community_area > 8;
update g1 set tolls = tolls + 90 where pickup_community_area > 64;
update g1 set fare = fare + 17 where pickup_community_area > 20;
update g1 set trip_total = trip_total + 13 where pickup_community_area > 31;
update g1 set extras = extras + 16 where pickup_community_area > 60;
update g1 set fare = fare + 52 where pickup_community_area > 64;
update g1 set fare = fare + 61 where pickup_community_area > 9;
update g1 set trip_total = trip_total + 7 where pickup_community_area > 22;
update g1 set trip_total = trip_total + 39 where pickup_community_area > 72;
update g1 set tolls = tolls + 18 where pickup_community_area > 11;
update g1 set extras = extras + 51 where pickup_community_area > 62;
update g1 set fare = fare + 88 where pickup_community_area > 40;
update g1 set fare = fare + 81 where pickup_community_area > 59;
update g1 set fare = fare + 13 where pickup_community_area > 42;
update g1 set trip_total = trip_total + 63 where pickup_community_area > 54;
update g1 set tolls = tolls + 2 where pickup_community_area > 74;
update g1 set fare = fare + 84 where pickup_community_area > 71;
update g1 set fare = fare + 64 where pickup_community_area > 68;
update g1 set extras = extras + 38 where pickup_community_area > 66;
update g1 set extras = extras + 74 where pickup_community_area > 51;
update g1 set trip_total = trip_total + 80 where pickup_community_area > 38;
update g1 set extras = extras + 33 where pickup_community_area > 68;
update g1 set trip_total = trip_total + 10 where pickup_community_area > 56;
update g1 set fare = fare + 11 where pickup_community_area > 52;
update g1 set tolls = tolls + 63 where pickup_community_area > 17;
update g1 set tolls = tolls + 16 where pickup_community_area > 29;
update g1 set trip_total = trip_total + 10 where pickup_community_area > 76;
update g1 set tolls = tolls + 71 where pickup_community_area > 38;
update g1 set tolls = tolls + 24 where pickup_community_area > 41;
update g1 set extras = extras + 66 where pickup_community_area > 68;
update g1 set extras = extras + 49 where pickup_community_area > 61;
update g1 set tolls = tolls + 38 where pickup_community_area > 77;
update g1 set fare = fare + 87 where pickup_community_area > 61;
update g1 set fare = fare + 89 where pickup_community_area > 41;
update g1 set tolls = tolls + 3 where pickup_community_area > 38;
update g1 set fare = fare + 18 where pickup_community_area > 71;
update g1 set extras = extras + 6 where pickup_community_area > 23;
update g1 set fare = fare + 3 where pickup_community_area > 24;
update g1 set tolls = tolls + 17 where pickup_community_area > 60;
update g1 set tolls = tolls + 33 where pickup_community_area > 61;
update g1 set tolls = tolls + 44 where pickup_community_area > 56;
update g1 set extras = extras + 65 where pickup_community_area > 71;
update g1 set extras = extras + 83 where pickup_community_area > 39;
update g1 set extras = extras + 92 where pickup_community_area = 8;
update g1 set trip_total = trip_total + 50 where pickup_community_area = 8;
update g1 set fare = fare + 97 where pickup_community_area = 8;
update g1 set extras = extras + 81 where pickup_community_area = 8;
update g1 set tolls = tolls + 29 where pickup_community_area = 8;
update g1 set fare = fare + 18 where pickup_community_area = 8;
update g1 set tolls = tolls + 42 where pickup_community_area = 8;
update g1 set fare = fare + 71 where pickup_community_area = 8;
update g1 set tolls = tolls + 20 where pickup_community_area = 8;
update g1 set tolls = tolls + 61 where pickup_community_area = 8;
update g1 set fare = fare + 45 where pickup_community_area = 8;
update g1 set tolls = tolls + 39 where pickup_community_area = 8;
update g1 set extras = extras + 87 where pickup_community_area = 8;
update g1 set fare = fare + 95 where pickup_community_area = 8;
update g1 set fare = fare + 15 where pickup_community_area = 8;
update g1 set extras = extras + 88 where pickup_community_area = 8;
update g1 set extras = extras + 86 where pickup_community_area = 8;
update g1 set tolls = tolls + 46 where pickup_community_area = 8;
update g1 set tolls = tolls + 81 where pickup_community_area = 8;
update g1 set trip_total = trip_total + 25 where pickup_community_area = 8;
update g1 set tolls = tolls + 39 where pickup_community_area > 22;
update g1 set fare = fare + 89 where pickup_community_area > 77;
update g1 set fare = fare + 73 where pickup_community_area > 32;
update g1 set tolls = tolls + 25 where pickup_community_area > 60;
update g1 set tolls = tolls + 83 where pickup_community_area > 63;
update g1 set fare = fare + 55 where pickup_community_area > 72;
update g1 set extras = extras + 99 where pickup_community_area > 22;
update g1 set trip_total = trip_total + 59 where pickup_community_area > 74;
update g1 set fare = fare + 94 where pickup_community_area > 55;
update g1 set extras = extras + 22 where pickup_community_area > 71;
update g1 set extras = extras + 68 where pickup_community_area > 28;
update g1 set fare = fare + 66 where pickup_community_area > 40;
update g1 set tolls = tolls + 91 where pickup_community_area > 64;
update g1 set fare = fare + 0 where pickup_community_area > 59;
update g1 set fare = fare + 64 where pickup_community_area > 57;
update g1 set tolls = tolls + 90 where pickup_community_area > 43;
update g1 set trip_total = trip_total + 45 where pickup_community_area > 17;
update g1 set fare = fare + 24 where pickup_community_area > 39;
update g1 set fare = fare + 39 where pickup_community_area > 37;
update g1 set trip_total = trip_total + 88 where pickup_community_area > 53;
update g1 set tolls = tolls + 97 where pickup_community_area > 8;
update g1 set tolls = tolls + 38 where pickup_community_area > 44;
update g1 set extras = extras + 73 where pickup_community_area > 10;
update g1 set tolls = tolls + 37 where pickup_community_area > 53;
update g1 set extras = extras + 82 where pickup_community_area > 63;
update g1 set extras = extras + 2 where pickup_community_area > 74;
update g1 set fare = fare + 59 where pickup_community_area > 41;
update g1 set extras = extras + 89 where pickup_community_area > 47;
update g1 set fare = fare + 34 where pickup_community_area > 55;
update g1 set tolls = tolls + 37 where pickup_community_area > 27;
update g1 set trip_total = trip_total + 68 where pickup_community_area > 17;
update g1 set fare = fare + 5 where pickup_community_area > 43;
update g1 set trip_total = trip_total + 29 where pickup_community_area > 19;
update g1 set tolls = tolls + 30 where pickup_community_area > 43;
update g1 set trip_total = trip_total + 69 where pickup_community_area > 75;
update g1 set fare = fare + 8 where pickup_community_area > 64;
update g1 set tolls = tolls + 35 where pickup_community_area > 31;
update g1 set tolls = tolls + 77 where pickup_community_area > 12;
update g1 set fare = fare + 79 where pickup_community_area > 32;
update g1 set extras = extras + 8 where pickup_community_area > 52;
update g1 set trip_total = trip_total + 18 where pickup_community_area > 27;
update g1 set extras = extras + 81 where pickup_community_area > 53;
update g1 set fare = fare + 61 where pickup_community_area > 35;
update g1 set extras = extras + 100 where pickup_community_area > 15;
update g1 set extras = extras + 68 where pickup_community_area > 57;
update g1 set tolls = tolls + 91 where pickup_community_area > 17;
update g1 set extras = extras + 38 where pickup_community_area > 35;
update g1 set tolls = tolls + 63 where pickup_community_area > 57;
update g1 set fare = fare + 33 where pickup_community_area > 11;
update g1 set tolls = tolls + 44 where pickup_community_area > 74;
update g1 set fare = fare + 35 where pickup_community_area > 74;
update g1 set tolls = tolls + 77 where pickup_community_area > 16;
update g1 set trip_total = trip_total + 62 where pickup_community_area > 30;
update g1 set fare = fare + 88 where pickup_community_area > 16;
update g1 set extras = extras + 89 where pickup_community_area > 43;
update g1 set extras = extras + 25 where pickup_community_area > 49;
update g1 set fare = fare + 17 where pickup_community_area > 50;
update g1 set trip_total = trip_total + 4 where pickup_community_area > 43;
update g1 set tolls = tolls + 95 where pickup_community_area > 11;
update g1 set fare = fare + 84 where pickup_community_area > 20;
update g1 set fare = fare + 100 where pickup_community_area > 25;
update g1 set fare = fare + 61 where pickup_community_area > 71;
update g1 set tolls = tolls + 47 where pickup_community_area > 57;
update g1 set trip_total = trip_total + 27 where pickup_community_area > 71;
update g1 set trip_total = trip_total + 54 where pickup_community_area > 38;
update g1 set tolls = tolls + 99 where pickup_community_area > 8;
update g1 set fare = fare + 47 where pickup_community_area > 17;
update g1 set trip_total = trip_total + 28 where pickup_community_area > 33;
update g1 set tolls = tolls + 16 where pickup_community_area > 25;
update g1 set tolls = tolls + 8 where pickup_community_area > 63;
update g1 set tolls = tolls + 26 where pickup_community_area > 33;
update g1 set trip_total = trip_total + 21 where pickup_community_area > 20;
update g1 set fare = fare + 32 where pickup_community_area > 26;
update g1 set extras = extras + 5 where pickup_community_area > 49;
update g1 set extras = extras + 34 where pickup_community_area > 58;
update g1 set fare = fare + 1 where pickup_community_area > 41;
update g1 set extras = extras + 59 where pickup_community_area > 32;
update g1 set trip_total = trip_total + 67 where pickup_community_area > 17;
update g1 set fare = fare + 96 where pickup_community_area > 28;
update g1 set fare = fare + 64 where pickup_community_area > 62;
update g1 set extras = extras + 36 where pickup_community_area > 67;
update g1 set fare = fare + 20 where pickup_community_area > 61;
update g1 set fare = fare + 16 where pickup_community_area > 9;
update g1 set extras = extras + 55 where pickup_community_area > 15;
update g1 set trip_total = trip_total + 86 where pickup_community_area > 20;
update g1 set extras = extras + 45 where pickup_community_area > 32;
update g1 set trip_total = trip_total + 66 where pickup_community_area > 28;
update g1 set fare = fare + 85 where pickup_community_area > 71;
update g1 set extras = extras + 61 where pickup_community_area > 19;
update g1 set fare = fare + 69 where pickup_community_area > 8;
update g1 set extras = extras + 45 where pickup_community_area > 45;
update g1 set fare = fare + 68 where pickup_community_area > 16;
update g1 set tolls = tolls + 87 where pickup_community_area > 14;
update g1 set extras = extras + 64 where pickup_community_area > 57;
update g1 set tolls = tolls + 58 where pickup_community_area > 8;
update g1 set trip_total = trip_total + 0 where pickup_community_area > 8;
update g1 set trip_total = trip_total + 94 where pickup_community_area > 62;
update g1 set extras = extras + 91 where pickup_community_area > 29;
update g1 set trip_total = trip_total + 18 where pickup_community_area > 28;
update g1 set tolls = tolls + 92 where pickup_community_area > 40;);
explain analyze (select * from g except select * from g1) union (select * from g1 except select * from g);
